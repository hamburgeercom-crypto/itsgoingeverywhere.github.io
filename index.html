<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GPT‑5 Chat (device‑3)</title>
  <style>
    body { font-family: sans-serif; background:#111; color:#eee; margin:0; }
    #chat { padding:20px; height:80vh; overflow-y:auto; white-space:pre-wrap; }
    #inputBar { display:flex; padding:10px; background:#222; }
    #msg { flex:1; padding:10px; font-size:16px; }
    #send { padding:10px 20px; font-size:16px; }
  </style>
</head>
<body>

<div id="chat">═══ GPT‑5 Chat (device‑3) ═══</div>

<div id="inputBar">
  <input id="msg" placeholder="Type a message…">
  <button id="send">Send</button>
</div>

<script>
// ─────────────────────────────────────────────────────────
// CONFIG
// ─────────────────────────────────────────────────────────
const SECRET_KEY = "imasigmaskibidyhawktoahawk"; // your shared secret
const BASE = "https://device-3.kingcobraroblox.workers.dev/v1"; // your worker URL

const MODELS = {
  mini: "gpt-4.1-mini",   // verified real
  full: "gpt-5-mini-2025-08-07"
};

let model = "full";

// ─────────────────────────────────────────────────────────
// UI HELPERS
// ─────────────────────────────────────────────────────────
const chatBox = document.getElementById("chat");
function say(t){
  chatBox.textContent += "\n" + t;
  chatBox.scrollTop = chatBox.scrollHeight;
}

// ─────────────────────────────────────────────────────────
// HTTP HELPERS
// ─────────────────────────────────────────────────────────
async function post(url, body) {
  const r = await fetch(url, {
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "X-Secret-Key": btoa(btoa(SECRET_KEY))
    },
    body: JSON.stringify(body)
  });
  return r.json();
}

// ─────────────────────────────────────────────────────────
// MAIN CHAT FUNCTION (Responses API)
// ─────────────────────────────────────────────────────────
async function chat(msg) {
  const res = await post(BASE + "/responses", {
    model: MODELS[model],
    input: msg
  });

  // Responses API unified output
  return res.output_text || "[no output]";
}

// ─────────────────────────────────────────────────────────
// SEND BUTTON
// ─────────────────────────────────────────────────────────
document.getElementById("send").onclick = async () => {
  const raw = document.getElementById("msg").value.trim();
  if (!raw) return;

  say("\nYou: " + raw);
  document.getElementById("msg").value = "";

  try {
    const reply = await chat(raw);
    say("GPT: " + reply);
  } catch (e) {
    say("[error: " + e.message + "]");
  }
};
</script>

</body>
</html>

